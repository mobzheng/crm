<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.sm.crm.mapper.RightMapper">
    <resultMap id="right" type="com.sm.crm.entity.Right">
        <id property="rid" column="rid"/>
        <result property="rName" column="r_name"/>
        <result property="rDes" column="r_des"/>
        <result property="rState" column="r_state"/>
        <collection property="roles" ofType="com.sm.crm.entity.Role"
                 column="rid"   select="com.sm.crm.mapper.RoleMapper.findRoleByRightId"/>
    </resultMap>

    <select id="findRightByRoleId" resultMap="right">
        select * from `right` r right join role_right rr on r.rid=rr.right_id where rr.role_id=#{role_id}
    </select>

    <select id="findAllRights" resultMap="right">
        SELECT * FROM `right`
    </select>

    <insert id="updateRightMenu">
        insert into right_menu(right_id,menu_id) values
        <foreach collection="menuId" item="menu" separator=",">
            (#{rid},${menu})
        </foreach>
    </insert>

    <delete id="deleteRightMenuByrid" parameterType="int">
        delete from right_menu where right_id=#{rid}
    </delete>

</mapper>